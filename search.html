<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ========================================
         META TAGS AND BASIC CONFIGURATION
         ======================================== -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search - Lemmeric</title>
    
    <!-- ========================================
         EXTERNAL STYLESHEETS
         ======================================== -->
    <!-- Bootstrap CSS Framework -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- ========================================
         THEME PREVENTION SCRIPT
         ======================================== -->
    <!-- This script prevents white flash by applying theme before page renders -->
    <script>
        (function() {
            // Get theme from localStorage or default to system preference
            const getTheme = () => {
                try {
                    const saved = localStorage.getItem('lemmeric_theme');
                    if (saved && (saved === 'light' || saved === 'dark')) {
                        return saved;
                    }
                } catch (e) {
                    // localStorage not available
                }
                
                // Fallback to system preference
                return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            };
            
            // Apply theme immediately
            const theme = getTheme();
            document.documentElement.setAttribute('data-theme', theme);
            
            // Set CSS custom properties for immediate effect
            if (theme === 'dark') {
                document.documentElement.style.setProperty('--bs-body-bg', '#1a1a1a');
                document.documentElement.style.setProperty('--bs-body-color', '#ffffff');
                document.documentElement.style.setProperty('background-color', '#1a1a1a');
                document.documentElement.style.setProperty('color', '#ffffff');
            }
        })();
    </script>

    <!-- ========================================
         CUSTOM STYLESHEETS
         ======================================== -->
    <!-- Main application styles -->
    <link href="assets/css/main.css" rel="stylesheet">
    <!-- Theme management styles -->
    <link href="assets/css/themes.css" rel="stylesheet">
</head>
<body>
    <!-- ========================================
         NAVIGATION
         ======================================== -->
    <!-- Navigation will be loaded by navbar component -->

    <!-- ========================================
         SEARCH PAGE CONTAINER
         ======================================== -->
    <div id="search-page" class="container-fluid">
        <!-- ========================================
             SEARCH HEADER SECTION
             ======================================== -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h1 class="h3 mb-0">
                        <i class="bi bi-search me-2"></i>Search Results
                    </h1>
                </div>
            </div>
        </div>

        <!-- ========================================
             SEARCH LAYOUT SECTION
             ======================================== -->
        <div class="row">
            <!-- ========================================
                 SEARCH SIDEBAR
                 ======================================== -->
            <div class="col-lg-3 col-md-4 mb-4 search-sidebar">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="bi bi-funnel me-2"></i>Search Filters
                        </h5>
                    </div>
                    <div class="card-body">
                        <form id="search-filters-form">
                            <div class="mb-3">
                                <label for="search-query" class="form-label fw-bold">Search Query</label>
                                <input type="text" class="form-control" id="search-query" placeholder="Enter search terms..." required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="search-type" class="form-label fw-bold">Content Type</label>
                                <select class="form-select" id="search-type">
                                    <option value="All">All Types</option>
                                    <option value="Posts">Posts</option>
                                    <option value="Comments">Comments</option>
                                    <option value="Communities">Communities</option>
                                    <option value="Users">Users</option>
                                    <option value="Url">URLs</option>
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <label for="search-sort" class="form-label fw-bold">Sort By</label>
                                <select class="form-select" id="search-sort">
                                    <option value="TopAll">Top All Time</option>
                                    <option value="TopDay">Top Today</option>
                                    <option value="TopWeek">Top This Week</option>
                                    <option value="TopMonth">Top This Month</option>
                                    <option value="TopYear">Top This Year</option>
                                    <option value="Hot">Hot</option>
                                    <option value="New">Newest</option>
                                    <option value="Old">Oldest</option>
                                    <option value="MostComments">Most Comments</option>
                                    <option value="NewComments">New Comments</option>
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <label for="search-listing" class="form-label fw-bold">Listing</label>
                                <select class="form-select" id="search-listing">
                                    <option value="All">All Content</option>
                                    <option value="Local">Local Only</option>
                                    <option value="Subscribed">Subscribed Only</option>
                                </select>
                            </div>
                            
                            <button type="submit" class="btn btn-primary w-100" id="search-submit">
                                <i class="bi bi-search me-1"></i>Search
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- ========================================
                 SEARCH RESULTS SECTION
                 ======================================== -->
            <div class="col-lg-9 col-md-8">
                <div id="search-results-container" class="search-results-area">
                    <!-- Loading state -->
                    <div id="search-loading" class="text-center py-5" style="display: none;">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-3 text-muted">Searching...</p>
                    </div>

                    <!-- No results state -->
                    <div id="search-no-results" class="text-center py-5" style="display: none;">
                        <i class="bi bi-search display-1 text-muted"></i>
                        <h3 class="mt-3">No results found</h3>
                        <p class="text-muted">Try adjusting your search terms or filters.</p>
                    </div>

                    <!-- Error state -->
                    <div id="search-error" class="text-center py-5" style="display: none;">
                        <i class="bi bi-exclamation-triangle display-1 text-danger"></i>
                        <h3 class="mt-3">Search failed</h3>
                        <p class="text-muted" id="search-error-message">An error occurred while searching.</p>
                        <button class="btn btn-primary" id="search-retry">Try Again</button>
                    </div>

                    <!-- Results list -->
                    <div id="search-results-list" style="display: none;">
                        <!-- Results will be populated here -->
                    </div>

                    <!-- Load more button -->
                    <div id="search-load-more" class="text-center mt-4" style="display: none;">
                        <button class="btn btn-outline-primary" id="load-more-btn">
                            <i class="bi bi-arrow-down me-1"></i>Load More Results
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Our JavaScript modules -->
    <script type="module" src="js/config.js"></script>
    <script type="module" src="js/api.js"></script>
    <script type="module" src="js/utils.js"></script>
    <script type="module" src="js/components/navbar.js"></script>
    <script type="module" src="js/search-page.js"></script>
</body>
</html>
